# Don't add cunit tests here, they get added conditionally below
MODULE_APPS:= xdrspeed bmitest timertest forwarding iofwdreceive iofwdsend \
   smlinks smtest workqueue levelmatch iofwdlog regexfilter completion \
   zoidfs-io zoidfs-md zoidfs-io-iofwd zoidfs-md-iofwd zoidfsapi-symlink-test \
   zoidfsapi-link-test zoidfsapi-rename-test zoidfsapi-lookup-perm-test \
   zoidfs-io-thread zoidfs-md-thread zoidfs-io-iofwd-thread \
   zoidfs-md-iofwd-thread configparser

MODULE_SOURCES_configparser := configparser.c
ADDINTLIBS_configparser := c-util

MODULE_SOURCES_completion := completion.cpp
ADDINTLIBS_completion := iofwdutil

MODULE_SOURCES_regexfilter := regexfilter.cpp
ADDINTLIBS_regexfilter := iofwdutil

MODULE_SOURCES_iofwdlog := iofwdlog.cpp
ADDINTLIBS_iofwdlog := iofwdutil

MODULE_SOURCES_levelmatch := levelmatch.cpp
ADDINTLIBS_levelmatch := iofwdutil

MODULE_SOURCES_workqueue := workqueue.cpp
ADDINTLIBS_workqueue := taskmon iofwdutil 

MODULE_SOURCES_smlinks := smlinks.cpp
ADDINTLIBS_smlinks := sm iofwdutil

MODULE_SOURCES_smtest := smtest.cpp
ADDINTLIBS_smtest := sm iofwdutil

MODULE_SOURCES_smtest := smtest.cpp
ADDINTLIBS_smtest := sm iofwdutil

MODULE_SOURCES_iofwdsend := iofwdsend.cpp
ADDINTLIBS_iofwdsend := iofwdclient iofwdlib zoidfsutil iofwdutil

MODULE_SOURCES_iofwdreceive := iofwdreceive.cpp
ADDINTLIBS_iofwdreceive := iofwdlib iofwdutil

MODULE_SOURCES_forwarding := forwarding.cpp
ADDINTLIBS_forwarding := iofwdutil 

MODULE_SOURCES_zoidfs-io := zoidfs-io.c 
ADDINTLIBS_zoidfs-io := zoidfsutil zoidfsdispatch zoidfscutil

MODULE_SOURCES_zoidfs-md := zoidfs-md.c
ADDINTLIBS_zoidfs-md := zoidfsutil zoidfsdispatch zoidfscutil

MODULE_SOURCES_zoidfs-io-iofwd := zoidfs-io.c 
ADDINTLIBS_zoidfs-io-iofwd := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil

MODULE_SOURCES_zoidfs-md-iofwd := zoidfs-md.c
ADDINTLIBS_zoidfs-md-iofwd := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil

MODULE_SOURCES_zoidfs-io-thread := zoidfs-io-thread.c 
ADDINTLIBS_zoidfs-io-thread := zoidfsutil zoidfsdispatch  zoidfscutil

MODULE_SOURCES_zoidfs-md-thread := zoidfs-md-thread.c
ADDINTLIBS_zoidfs-md-thread := zoidfsutil zoidfsdispatch  zoidfscutil

MODULE_SOURCES_zoidfs-io-iofwd-thread := zoidfs-io-thread.c 
ADDINTLIBS_zoidfs-io-iofwd-thread := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil

MODULE_SOURCES_zoidfs-md-iofwd-thread := zoidfs-md-thread.c
ADDINTLIBS_zoidfs-md-iofwd-thread := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil

MODULE_SOURCES_zoidfsapi-symlink-test := zoidfsapi-symlink-test.c
ADDINTLIBS_zoidfsapi-symlink-test := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil

MODULE_SOURCES_zoidfsapi-link-test := zoidfsapi-link-test.c
ADDINTLIBS_zoidfsapi-link-test := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil

MODULE_SOURCES_zoidfsapi-rename-test := zoidfsapi-rename-test.c
ADDINTLIBS_zoidfsapi-rename-test := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil

MODULE_SOURCES_zoidfsapi-lookup-perm-test := zoidfsapi-lookup-perm-test.c 
ADDINTLIBS_zoidfsapi-lookup-perm-test := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil

MODULE_SOURCES_bmitest := $(addprefix bmi/, bmi.cpp)
ADDINTLIBS_bmitest := iofwdutil
LDFLAGS_bmitest := $(BOOST_THREAD_LDFLAGS)
LIBS_bmitest := $(BOOST_THREAD_LIBS)

MODULE_SOURCES_timertest := $(addprefix timer/, timer.cpp)
ADDINTLIBS_timertest := iofwdutil

MODULE_SOURCES_xdrspeed := $(addprefix xdr/, xdrspeed.cpp)
ADDINTLIBS_xdrspeed := iofwdutil

ifdef ENABLE_CUNIT

# there are no per-app/file CPPFLAGS/CFLAGS yet...
CPPFLAGS += @CUNIT_CPPFLAGS@
CFLAGS += @CUNIT_CFLAGS@

MODULE_APPS += gencache-unit 
MODULE_SOURCES_gencache-unit := gencache-unit.c
LIBS_gencache-unit := @CUNIT_LDFLAGS@ @CUNIT_LIBS@
ADDINTLIBS_gencache-unit := c-util zoidfscutil
LDFLAGS_gencache-unit := @CUNIT_LDFLAGS@

MODULE_APPS += fcache-unit 
MODULE_SOURCES_fcache-unit := fcache-unit.c
LIBS_fcache-unit := @CUNIT_LIBS@
ADDINTLIBS_fcache-unit := c-util zoidfsdispatch zoidfscutil
LDFLAGS_fcache-unit := @CUNIT_LDFLAGS@

MODULE_APPS += dcache-unit 
MODULE_SOURCES_dcache-unit := dcache-unit.c
LIBS_dcache-unit := @CUNIT_LIBS@
ADDINTLIBS_dcache-unit := c-util zoidfsdispatch zoidfscutil
LDFLAGS_dcache-unit := @CUNIT_LDFLAGS@

MODULE_APPS += zoidfs-md-cunit
MODULE_SOURCES_zoidfs-md-cunit := zoidfs-md-cunit.c 
ADDINTLIBS_zoidfs-md-cunit := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil
LDFLAGS_zoidfs-md-cunit := @CUNIT_LDFLAGS@ @CUNIT_LIBS@
LIBS_zoidfs-md-cunit := @CUNIT_LIBS@

MODULE_APPS += zoidfs-md-cunit-local
MODULE_SOURCES_zoidfs-md-cunit-local := zoidfs-md-cunit.c 
ADDINTLIBS_zoidfs-md-cunit-local := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsdispatch zoidfscutil
LDFLAGS_zoidfs-md-cunit-local := @CUNIT_LDFLAGS@ @CUNIT_LIBS@
LIBS_zoidfs_md-cunit-local := @CUNIT_LIBS@

MODULE_APPS += zoidfs-io-cunit
MODULE_SOURCES_zoidfs-io-cunit := zoidfs-io-cunit.c 
ADDINTLIBS_zoidfs-io-cunit := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsclient zoidfscutil
LDFLAGS_zoidfs-io-cunit := @CUNIT_LDFLAGS@ @CUNIT_LIBS@
LIBS_zoidfs-io-cunit := @CUNIT_LIBS@

MODULE_APPS += zoidfs-io-cunit-local
MODULE_SOURCES_zoidfs-io-cunit-local := zoidfs-io-cunit.c 
ADDINTLIBS_zoidfs-io-cunit-local := iofwdclient iofwdlib iofwdutil zoidfsutil zoidfsdispatch zoidfscutil
LDFLAGS_zoidfs-io-cunit-local := @CUNIT_LDFLAGS@ @CUNIT_LIBS@
LIBS_zoidfs-io-cunit-local := @CUNIT_LIBS@

MODULE_APPS += configfile
MODULE_SOURCES_configfile := configfile.c
ADDINTLIBS_configfile := c-util

endif
